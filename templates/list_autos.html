<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Lista de Autos</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/list.css') }}">
</head>
<body>
    <h1>Autos registrados en la cochera</h1>

    <form method="POST">
        <input type="text" name="buscar" placeholder="Buscar por patente, DNI o ticket" value="{{ search_value or '' }}">
        <button type="submit">Buscar</button>
    </form>

    <table border="1" cellpadding="5">
        <tr>
            <th>ID</th>
            <th>Ticket</th>
            <th>Fecha Ingreso</th>
            <th>Hora Ingreso</th>
            <th>Marca</th>
            <th>Color</th>
            <th>Patente</th>
            <th>DNI</th>
            <th>Teléfono</th>
            <th>Fecha Salida</th>
            <th>Hora Salida</th>
            <th>Tiempo (min)</th>
            <th>Monto Total</th>
            <th>Retirado</th>
            <th>Acciones</th>
        </tr>

        {% for auto in autos %}
        <tr>
            <td>{{ auto['id'] }}</td>
            <td>{{ auto['ticket'] }}</td>
            <td>{{ auto['fecha_ingreso'] }}</td>
            <td>{{ auto['hora_ingreso'] }}</td>
            <td>{{ auto['marca'] }}</td>
            <td>{{ auto['color'] }}</td>
            <td>{{ auto['patente'] }}</td>
            <td>{{ auto['dni'] }}</td>
            <td>{{ auto['telefono'] }}</td>
            <td>{{ auto['fecha_salida'] or '-' }}</td>
            <td>{{ auto['hora_salida'] or '-' }}</td>
            <td>{{ auto['tiempo_min'] if auto['tiempo_min'] is not none else '-' }}</td>
            <td>{{ "$%.2f"|format(auto['monto_total']) if auto['monto_total'] else '-' }}</td>
            <td>{{ 'Sí' if auto['retirado'] else 'No' }}</td>
            <td>
                {% if not auto['retirado'] %}
                    <a href="{{ url_for('edit_auto', id=auto['id']) }}"><button>Editar</button></a>
                    <form method="POST" action="{{ url_for('retirar_auto') }}" style="display:inline;">
                        <input type="hidden" name="ticket" value="{{ auto['ticket'] }}">
                        <button type="submit">Retirar</button>
                    </form>
                {% else %}
                    -
                {% endif %}
            </td>
        </tr>
        {% endfor %}
    </table>

    <br>
    <a href="{{ url_for('menu') }}"><button>Volver al menú</button></a>
</body>
</html>
